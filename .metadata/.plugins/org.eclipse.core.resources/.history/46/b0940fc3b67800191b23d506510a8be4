package org.xxjr.busi.util.push.impl;

import java.util.HashMap;
import java.util.Map;

import org.ddq.common.util.StringUtil;
import org.xxjr.busi.util.push.AbstractInsureUtil;
import org.xxjr.busi.util.push.PushCode;
import org.xxjr.busi.util.push.PushPlatformUtils;
import org.xxjr.sys.util.NumberUtil;
import org.xxjr.sys.util.SysParamsUtil;
@PushCode(32)
public class PushFishUtil extends AbstractInsureUtil{

	@Override
	public Map<String, Object> response(Map<String, Object> row)
			throws Exception {
		Map<String, Object> result = new HashMap<String, Object>();
		int status = 2;
		Object message = null;
		
		String url = SysParamsUtil.getStringParamByKey("insure_fish_cfg_url", "https://cpa.yizhidayu.com/items/index/submit?adCode=xxjr");
		Map<String, String> connParam = new HashMap<String, String>();
		connParam.put("name", StringUtil.objectToStr(row.get("applyName")));
		connParam.put("phone", StringUtil.objectToStr(row.get("telephone")));
		connParam.put("idnum", StringUtil.objectToStr(row.get("identifyNo")));
		connParam.put("ip", StringUtil.objectToStr(row.get("applyIp")));
		connParam.put("user_agent", PushPlatformUtils.getUserAgent(row.get("userAgent")));
		
		if (PushPlatformUtils.isPushTest()) {
			connParam.put("idnum", "421023199005098514");
		}
		
		Map<String, Object> resMap = PushPlatformUtils.httpPost(url, connParam, true);
		if (NumberUtil.getInt(resMap.get("status"), -1) == 1) {
			status = 1;
		}
		message = resMap.get("message");
		result.put("status", status);
		result.put("message", message);
		return result;
	}

}
